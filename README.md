# Shellability Stuff

The problem: our complex $C(n)$ for $S_n$ for $n$ even and $n \geq 6$ is not shellable, because its top-dimensional simplices (those corresponding to conjugates of $(12)(34)…((n-1)n)$), of dimension $k = (n/2)-1$ meet only at faces of dimension $k-2$ (they meet on faces corresponding to conjugates of $(56)(78)…((n-1)n)$, where they meet exactly two other such simplices - if the removed pair of transpositions is $(ab)(cd)$, then the simplex meets there those simplices with it replaced by $(ac)(bd)$ and $(ad)(bc)$ - every other intersection is contained in one of these), not $k - 1$.

Idea for solution:

Let $C$ be any connected $n$-dimensional pure complex whose maximal simplices meet only at $n - 2$ dimensional faces (in the sense that for any two maximal simplices, the intersection is either empty or $n - 2$ dimensional). Let $\tilde{C}$ be the complex formed by retracting each simplex of $C$ orthogonally away from one of its maximal faces. Then $C$ and $\tilde{C}$ are homotopy equivalent (indeed, $\tilde{C}$ is a deformation retract of $C$), and the ($n-1$ dimensional) maximal simplices of $\tilde{C}$ (of which there are $n$ for each maximal simplex of $C$) meet only at $n-2$ dimensional faces (the same meetings as in $C$, plus the $n - 2$ dimensional faces of each simplex), so might be shellable.

Questions:

1. Is this *always* shellable?
2. If not, can we find some nice conditions for when it is shellable?
3. If not, can we find some argument using the extra structure that we have in our case to show that the ones that we care about are shellable?

Attempting to answer those:

1. Let's just try it:  
   We can construct our shelling in essentially two stages - once we get inside a maximal simplex of $C$, we will add all of its faces (that are in $\tilde{C}$), and when we move between them, we will pick one $n-2$-dimensional maximal intersection, and one maximal simplex of $C$ that we have not yet visited, and attempt to add all of its simplices. Let's say we start in some maximal simplex $S$ of $C$. Then the simplices of $\tilde{C}$ here are exactly the $n$ maximal faces of $S$. These are $n - 1$ dimensional, and every one of them meets every other one at an $n - 2$ dimensional face, so we can add them in any order. None of them are homology facets.  
   When adding a new maximal simplex of $C$, say $T$, we always choose $T$ to be connected to the complex of simplices that we have already added (which we shall call, for now, $D$) at some $n-2$ dimensional face $F$ (and maybe also some other places) - we can do this, as $C$, and hence $\tilde{C}$, is connected. That leaves three cases, based on the number $k$ of vertices of $T$ that already belong to $D$. There are at least $n - 1$ (as $T$ intersects $D$ at an $n - 2$ dimensional face), at at most $n + 1$ (as $T$ has $n + 1$ vertices).
	1. If $k = n - 1$, then there are two vertices $v$ and $w$ of $T$ which have not been added to $D$ yet. As only one maximal face of $T$ has been removed in $\tilde{C}$, at least one of $T \setminus \{v\}$ and $T \setminus \{w\}$ is a simplex of $\tilde{C}$, and its intersection with $D$ is pure and $n - 2$ dimensional, so we may add that simplex to our shelling, and then proceed to add every other maximal face of $T$ that is in $\tilde{C}$ as above (each intersects $D$ only at the face we just added and the internal $n-2$ dimensional intersections of each maximal face of $T$ with each other). None of them are homology facets.
	2. If $k = n$, then there is only one vertex $v$ of $T$ which has not yet been added to $D$, and one vertex $w$ which has. If $T \setminus\{v\}$ is in $\tilde{C}$, then we proceed as above. If not, then since $w$ has been added to $D$, it must have been added as part of some simplex $U$ of $C$, all of whose maximal faces (that are in $\tilde{C}$) we added, because that's the only way that we ever add anything to $D$. Since that simplex intersects $T$ (at $w$), it must intersect at an $n - 2$ dimensional face $G$. The other $n - 2$ vertices of $G$ must all lie in $F$, so that $G \setminus \{w\} = F \setminus \{u\}$ for some $u \in F$. Consider the simplex $U = G \cup \{u\} = F \cup \{w\} = T \setminus \{v\}$, which intersects $D$ at least at $G$ and $F$. Now consider any $k$-dimensional face $H$ of $U$ for $k < n - 2$ . If $H$ is in $D$, then it must have been added as part of some $n - 2$ dimensional intersection with $T$, which cannot contain $v$ (as $v$ has not yet been added), so must be contained in $U$. Thus, the intersection of $U$ with $D$ is pure and $n-2$-dimensional, so we may add it to $D$. We may then add all other maximal faces of $T$ contained in $\tilde{C}$ as above.
	3. If $k = n + 1$, choose one vertex $v$ of $T$ not contained in $F$ (of which there are two) such that $F \cup \{v\}$ is not the maximal face that we deleted from $T$ in forming $\tilde{C}$ (of which there is at least one, as we deleted only one such face). Let $w$ be the other vertex of $T$ not contained in $F$. As $v$ has been added to $D$, it must have been added as part of a simplex of $C$ whose maximal faces were all added, and which intersects $T$, and therefore must intersect $T$ at some $n-2$ dimensional face $G$. Then we again have two cases:
		1. If $G$ contains $w$, then consider all other possible choices for $G$. If all fail, skip adding $T$ via $F$ for now.
		2. If $G$ does not contain $w$, then $G = (F \setminus \{u\}) \cup \{v\}$ for some $u \in F$, and so we may add the simplex $U = G \cup \{u\} = F \cup \{v\} = T \setminus \{w\}$. If there is no maximal simplex $H$ of $D \cap U$ of dimension $k < n - 2$, then we may add $H$, and subsequently every other simplex of $\tilde{C}$ contained in $D$ (as $w$ has been added, it was added in something that intersects $T$ at a $k - 2$ dimensional face $J$, so the intersection of $U$ with $D$ is pure and $n-2$ dimensional). If there is such a maximal simplex, then since $H$ is in $D$, it must have been added as part of a $k - 2$ dimensional intersection $I$ with $T$, which cannot be contained in $U$ (else $H$ would not be maximal). Thus, we must have $I = H \cup \{w\}$, and $H$ must have dimension $n - 3$. We thus cannot add $U$. We now go back to the start of the $k = n + 1$ case and try a different choice of $G$. If all choices fail, we skip adding $T$ via $F$ for now.  
	After following the above procedure as far as we can, either we have a full shelling of $\tilde{C}$, or we have a partial shelling $D$ of $\tilde{C}$, together with a collection of simplices of $C$ which have fallen into one of the two failure cases in case 3 above for all approaches. We shall now consider these latter simplices, or rather their $n-2$ dimensional faces which are in $\tilde{C}$.  
	Let $T$ be such a simplex, and let $U$ be its $n-1$ dimensional face which lies in $\tilde{C}$ with the highest number $j$ of $n - 2$ dimensional faces in its intersection with $D$ (breaking ties arbitrarily). We now take cases with $j(T)$, and will add our simplices in descending order of $j(T)$, which we shall recalculate after adding each simplex:
	1. If $j(T) = n$, then all proper faces of $U$ have already been added, so $U$ can be added to our shelling as a homology facet, and subsequently all other maximal faces of $T$ in $\tilde{C}$ as above (not necessarily as homology facets).
	2. If $j(T) = n - 1$, then the only proper face of $U$ not contained in $D$ is the unique maximal face $G$ of $U$ not contained in $D$: if $F$ is another such, it either is $n-2$ dimensional (but then it would be contained in $D$), or it is contained in something $n-2$ dimensional other than $U$ (so would be contained in D). The intersection of $U$ with $D$ is therefore pure and $n-2$ dimensional, so we may add $U$ to $D$, followed by all other maximal faces of $T$ in $\tilde{C}$.
	3. If $j(T) \leq n - 2$, then problems can arise - the minimal example has $n = 3$, where exactly one pair of non-adjacent edges has already been added to $D$ - in this case, every face of $T$ intersects $D$ at one edge and the opposite vertex, so none can be added. 

Thus, problems can only arise if every remaining maximal simplex has $j(T) \leq n - 2$. But there are further restrictions on these cases. For the next section, we'll assume that $j(T) \leq n - 2$. This places quite strict bounds on the number of $n-2$ dimensional faces of $T$ that can intersect with $D$ - in fact, at least $n + 1$ faces must not be included (there are at most $j(T)$ that are missing each vertex, and there are $n + 1$ vertices, but each misses two vertices, so this gives a maximum of $(n + 1)j(T)/2$ such faces included, out of a total of $n(n+1)/2 = (n^2 + n)/2$, so we miss at least $(n^{2}+ n - (n+1)j(T)/2$ faces. Since $j(T) \leq n - 2$, that's at least $(n^2+ n - (n+1)(n-2))/2=n+1$).


---

And that's about as far as I've got so far - I'm not sure if the problem cases ever actually come up in our case, and if they do, if there's a way around it by adding things in a clever order - that's the next thing to check. It seems likely that it is avoidable - the conditions for it to go wrong seem fairly specific (you'd need a collection of simplices such that for each simplex in the collection, $n + 1$ of its codimension 2 faces only meet other simplices in the collection, and they have to be distributed in exactly the wrong way around every simplex). 
